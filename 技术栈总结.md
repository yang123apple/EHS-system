# EHS 系统技术栈总结

## 项目概述
**项目名称**: Hytzer EHS System (环境、健康与安全管理系统)  
**版本**: 1.0  
**开发语言**: TypeScript

---

## 核心技术栈

### 前端框架
- **Next.js**: `^16.0.10` - React 全栈框架，支持 SSR/SSG
- **React**: `19.2.1` - UI 库
- **React DOM**: `19.2.1` - React DOM 渲染
- **React Compiler**: `babel-plugin-react-compiler@1.0.0` - React 编译器优化

### 编程语言
- **TypeScript**: `^5` - 类型安全的 JavaScript 超集
- **Node.js**: 运行时环境（通过 Next.js）

---

## 样式与 UI

### CSS 框架
- **Tailwind CSS**: `^4.1.17` - 实用优先的 CSS 框架
- **PostCSS**: `^8.5.6` - CSS 后处理器
- **Autoprefixer**: `^10.4.23` - 自动添加 CSS 浏览器前缀
- **@tailwindcss/postcss**: `^4.1.17` - Tailwind CSS PostCSS 插件

### UI 组件库
- **Lucide React**: `^0.556.0` - 图标库
- **class-variance-authority**: `^0.7.1` - 组件变体管理
- **clsx**: `^2.1.1` - 条件类名工具
- **tailwind-merge**: `^3.4.0` - Tailwind 类名合并工具

### 字体
- **Inter** (Google Fonts) - 通过 Next.js 字体优化加载

---

## 数据库与 ORM

### ORM
- **Prisma**: `^5.22.0` - 现代数据库 ORM
- **@prisma/client**: `^5.22.0` - Prisma 客户端

### 数据库
- **SQLite**: 开发环境数据库（`dev.db`）
- **PostgreSQL**: 生产环境支持（通过 `@prisma/adapter-pg@^7.1.0` 和 `pg@^8.16.3`）

### 数据库模型
项目包含以下主要数据模型：
- User（用户）
- Department（部门）
- HazardRecord（隐患记录）
- WorkPermitRecord（作业许可记录）
- TrainingMaterial（培训材料）
- TrainingTask（培训任务）
- Document（文档）
- SystemLog（系统日志）
- Notification（通知）
- 等...

---

## 文件处理库

### 文档处理
- **mammoth**: `^1.11.0` - Word (.docx) 文档转 HTML
- **xlsx**: `^0.18.5` - Excel 文件读写
- **pdf-lib**: `^1.17.1` - PDF 文件生成和操作

### 数据导入导出
- **papaparse**: `^5.5.3` - CSV 文件解析
- **jschardet**: `^3.1.4` - 字符编码检测

---

## 工具库

### 搜索与匹配
- **fuse.js**: `^7.1.0` - 模糊搜索库

### 环境配置
- **dotenv**: `^17.2.3` - 环境变量管理

### 其他工具
- **caniuse-lite**: `^1.0.30001762` - 浏览器兼容性数据

---

## 开发工具

### 代码质量
- **ESLint**: `^9.39.2` - JavaScript/TypeScript 代码检查
- **eslint-config-next**: `^16.0.8` - Next.js ESLint 配置

### 类型定义
- **@types/node**: `^20` - Node.js 类型定义
- **@types/react**: `^19` - React 类型定义
- **@types/react-dom**: `^19` - React DOM 类型定义
- **@types/papaparse**: `^5.5.2` - papaparse 类型定义

---

## 项目配置

### 构建配置
- **Next.js Config**: 启用 React Compiler 和 Turbopack
- **TypeScript Config**: 严格模式，ES2017 目标，路径别名 `@/*` → `./src/*`
- **PostCSS Config**: Tailwind CSS 和 Autoprefixer 插件

### 项目结构
```
src/
├── app/              # Next.js App Router 页面和路由
├── components/       # React 组件
│   ├── common/      # 公共组件
│   ├── ui/          # 基础 UI 组件
│   └── workflow/    # 工作流组件
├── lib/             # 工具库和 API 客户端
├── services/        # 业务服务层
├── types/           # TypeScript 类型定义
├── hooks/           # React Hooks
├── context/         # React Context
├── middleware/      # Next.js 中间件
└── utils/           # 工具函数

prisma/
├── schema.prisma    # 数据库模型定义
└── migrations/      # 数据库迁移文件
```

---

## 主要功能模块

1. **用户认证与权限管理**
   - 基于 Context API 的认证系统
   - 角色和权限控制

2. **隐患管理系统**
   - 隐患上报、整改、验收工作流
   - 风险等级评估
   - 工作流引擎

3. **作业许可管理**
   - 动态表单模板
   - 审批流程
   - 签名管理

4. **培训管理系统**
   - 培训材料管理（视频、PDF、Word）
   - 培训任务发布
   - 在线考试
   - 学习记录追踪

5. **文档管理系统**
   - 文档上传与版本管理
   - 文档搜索
   - 水印功能

6. **组织架构管理**
   - 部门层级管理
   - 用户管理
   - 批量导入

---

## 开发脚本

```json
{
  "dev": "next dev",              // 开发服务器
  "build": "next build",          // 生产构建
  "start": "next start",          // 生产服务器
  "lint": "eslint",               // 代码检查
  "postinstall": "prisma generate", // 安装后生成 Prisma 客户端
  "db:export": "node scripts/export-to-json.js",    // 导出数据库
  "db:import": "node scripts/import-from-json.js",  // 导入数据库
  "db:backup": "node scripts/export-to-json.js",    // 备份数据库
  "db:restore": "node scripts/restore-from-git.js"  // 恢复数据库
}
```

---

## 技术特点

1. **全栈 TypeScript**: 前后端统一使用 TypeScript，类型安全
2. **App Router**: 使用 Next.js 16 的 App Router 架构
3. **服务端渲染**: 支持 SSR 和 SSG，优化 SEO 和首屏加载
4. **组件化开发**: 高度模块化的组件架构
5. **类型安全**: Prisma ORM 提供端到端类型安全
6. **现代化 UI**: Tailwind CSS 4 + 自定义组件系统
7. **工作流引擎**: 自定义工作流引擎支持复杂业务流程
8. **文件处理**: 支持多种文件格式（Word、Excel、PDF、CSV）

---

## 部署环境

- **开发环境**: SQLite 数据库
- **生产环境**: PostgreSQL 数据库（通过 Prisma 适配器）
- **构建工具**: Next.js 内置构建系统（支持 Turbopack）

---

## 版本信息

- **Next.js**: 16.0.10
- **React**: 19.2.1
- **TypeScript**: 5.x
- **Prisma**: 5.22.0
- **Tailwind CSS**: 4.1.17

---

*最后更新: 2025年1月*

