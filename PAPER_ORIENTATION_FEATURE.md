# 纸张方向切换功能说明

## 功能概述

在所有涉及表单展示的页面中，新增了纸张方向切换按钮，允许用户在**纵向**和**横向**之间切换表单显示和打印方向。

## 实现位置

### 1. 模板编辑页面 (EditTemplateModal)
- **位置**: 模板编辑弹窗顶部工具栏
- **功能**: 切换模板预览方向
- **图标**: 🔄 (RotateCw)
- **显示**: "纵向" 或 "横向"

### 2. 新增作业单页面 (AddPermitModal)
- **位置**: 新增作业单弹窗顶部
- **功能**: 切换作业单填写表单的方向
- **图标**: 🔄 (RotateCw)
- **显示**: "纵向" 或 "横向"

### 3. 作业单详情页面 (RecordDetailModal)
- **位置**: 作业单详情弹窗顶部工具栏
- **功能**: 切换作业单查看和打印方向
- **图标**: 🔄 (RotateCw)
- **显示**: "纵向" 或 "横向"
- **特性**: 打印时自动应用所选方向

## 技术实现

### 核心组件修改

#### 1. ExcelRenderer.tsx
- 新增 `orientation?: 'portrait' | 'landscape'` 属性
- 默认值: `'portrait'` (纵向)
- 支持动态切换

#### 2. PrintStyle.tsx
- 新增 `orientation` 参数
- CSS 打印样式:
  ```css
  @page { 
    size: A4 portrait; /* 纵向 */
    size: A4 landscape; /* 横向 */
  }
  ```

#### 3. 各模态框组件
- 添加 `orientation` 状态管理
- 添加切换按钮 UI
- 将 orientation 传递给 ExcelRenderer

## 使用方式

### 用户操作
1. 打开任意包含表单的页面（模板编辑/作业单创建/作业单详情）
2. 点击顶部工具栏的 "纵向" 或 "横向" 按钮
3. 表单立即切换显示方向
4. 打印时会保持当前选择的方向

### 开发者接口
```typescript
<ExcelRenderer
  templateData={data}
  orientation="landscape" // 'portrait' | 'landscape'
  mode="view"
/>

<PrintStyle orientation="landscape" />
```

## 默认行为
- 所有页面默认为 **纵向** (portrait)
- 用户可随时切换
- 切换状态不会被持久化（刷新页面后恢复默认）

## 兼容性
- ✅ 支持所有现代浏览器
- ✅ 支持打印预览
- ✅ 支持 PDF 导出
- ✅ 与现有功能完全兼容

## 版本信息
- **功能添加日期**: 2025年12月22日
- **相关版本**: V3.2+
- **影响范围**: 所有表单展示页面

## 注意事项
1. 横向打印时，页面内容会自动适配 A4 横向尺寸
2. 打印边距已优化（0.5cm）
3. 方向切换不影响数据内容，仅改变显示布局
4. 建议在打印前预览确认效果
